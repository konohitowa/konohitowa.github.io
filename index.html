<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Philoppi - Porting Phillip Opperman&#39;s Rust OS blog from PC/x86_64 to Raspberry Pi 3B/Aarch64 by konohitowa</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/konohitowa/philoppi">View On GitHub</a></li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Philoppi - Porting Phillip Opperman&#39;s Rust OS blog from PC/x86_64 to Raspberry Pi 3B/Aarch64</h1>
          <p></p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/konohitowa">konohitowa</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h3>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h3>

<p>I decided I wanted to write an embedded OS with security as the focus. I also thought it would be cool to target the Raspberry Pi 3 Model B (henceforth called "3B") since it's cheap, powerful, and fairly well supported. Having decided my goal and the platform, the biggest decision I had remaining was what language I should use. I like C, but it's difficult to avoid shooting yourself in the foot with C. I considered writing some preprocessing hooks to handle things like range constraint checking and the like but decided to look around to see what was currently available. D was the first thing that came to mind but I wasn't necessarily sold (the compiler variants didn't make me that happy with it). I also found some other "pseudo Cs" that were interesting but not what I was looking for. I also considered Ada (I have a strong background in Ada) but really wanted something that felt closer to the hardware. And then I happened to see someone make a <a href="https://apple.slashdot.org/comments.pl?sid=9002357&amp;cid=51936975">facetious comment on slashdot about Rust</a> and wondered, "What's Rust?" The info at rust-lang.org jived with my needs, it was an active project, there was a reasonable manual and tutorial - sounded like a good candidate. I chewed through the guessing_game tutorial and then let that gestate for a bit while I did other things.</p>

<p>At the same time that I was trying to pick a language, I was also working on getting <a href="http://www.denx.de/wiki/U-Boot/">Das U-Boot</a> running on my 3B. That's still a work in progress, but it did give me the opportunity to dig into the resources available for the new Pi. Much has changed in the hardware and Broadcom isn't exactly speedy nor open with their SoC documentation. Fortunately, <a href="https://github.com/swarren" class="user-mention">@swarren</a> has not only been working on u-boot for the 3B, but also some other "bare metal" odds and ends. The one that I really needed was this: <a href="https://github.com/swarren/rpi-3-aarch64-demo">a dead-simple demo of serial I/O on the 3B</a> (the 64/ folder contains the code I used). Once I got that working, I felt like I was ready to jump back into the Rust part of things. But, honestly, I didn't know enough about Rust to know where to go next. That's where Philipp Oppermann's <a href="http://os.phil-opp.com">Write an OS in Rust</a> came in.</p>

<p><a href="https://github.com/phil-opp" class="user-mention">@phil-opp</a> has been writing an absolutely fantastic blog detailing his steps in bringing up an OS from first principles on an X86_64 PC (he's using QEMU, but it works just as well on VirtualBox or actual hardware). I found his blog riveting and educational. It was like binge-watching Netflix or reading a novel that I couldn't put down. When I had gotten current with his blog (it's an ongoing project), I felt ready to apply those lessons to the 3B.</p>

<p>So, in homage to Philipp's blog, and as a way to give back what was so freely given to me by him (prompted by a comment he made on <a href="https://www.reddit.com/r/rust">the rust subreddit</a>), I'll be blogging my experience in porting his OS to the 3B. I like the format of his blog, so I'll be following a similar layout and all of the blog and the ported code will be here on github.io and github.com.</p>
      </section>

    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    <div id="disqus_thread"></div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//konohitowa.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    </div>

  </body>
</html>
